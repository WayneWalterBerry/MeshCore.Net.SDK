# MeshCore Repeater Command Acceptance & Likelihood

## Command Acceptance Likelihood Table

| Command                       | Alias/Opcode                                                                                                                                                                                                                               | Transport(s)         | Preconditions (Role/Auth)                                                                                                              | Expected Response                                                                                                                                                                | Likely Error Cases                                                                                                                                                                 | Evidence Strength       | Likelihood (1–5) | Rationale                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------- | -------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------- | ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **PING/ECHO**                 | *(No specific code; uses generic request)*                                                                                                                                                                                                 | Over-air             | None (all nodes); rate-limit applied                                                                                                   | Echo or presence confirmation (e.g. via an advert or ack) from reachable nodes [\[reddit.com\]](https://www.reddit.com/r/meshtastic/comments/1cjppl0/can_we_ping_the_mesh/)      | No replies if out of range; ignored if spammed                                                                                                                                     | **Analog + Inference**  | **5**            | Basic connectivity check; trivial & read-only. Many mesh systems allow ad-hoc pinging (Meshtastic nodes send pings and get responses [\[reddit.com\]](https://www.reddit.com/r/meshtastic/comments/1cjppl0/can_we_ping_the_mesh/)). Low risk, so very likely supported via broadcast or simple request.                                                                                                                                            |
| **INFO / VERSION / “CAPS”**   | `ver` (prints firmware info) [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)                                                                                                            | Over-air, USB/BLE    | None (all roles); login as guest or higher                                                                                             | Firmware version and build info (capabilities implicitly) returned on console [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference) | Possibly *Timeout* if node restarts (for reboot) [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference); no response if unauthorized | **Direct (MeshCore)**   | **5**            | Universally supported query. Repeaters respond with their firmware version, build date, and capabilities to any authenticated node [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference). Harmless and essential for network debugging.                                                                                                                                                               |
| **NEIGHBORS / ADJACENCY**     | `neighbors` CLI (no opcode) [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)                                                                                                             | Over-air, USB/BLE    | Role = Repeater only; read access allowed                                                                                              | List of 0-hop neighbor IDs with link quality (e.g. RSSI/SNR) [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)                  | “N/A” on non-repeater nodes; returns empty if no neighbors                                                                                                                         | **Direct (MeshCore)**   | **4**            | Likely available on repeaters to report connectivity. MeshCore repeaters maintain a neighbor table and can dump it on request [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference). Many mesh protocols share neighbor info for network mapping [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/neighbor-info/).                                                               |
| **ROUTE TABLE / KNOWN PATHS** | *(No user CLI; implicit in contacts)*                                                                                                                                                                                                      | Over-air<sup>?</sup> | Role = Repeater or Companion; likely admin-only                                                                                        | Next-hop or learned route info for a given destination (if stored)                                                                                                               | Usually not exposed without trace; might require special trace command [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/neighbor-info/)                       | **Analog (Meshtastic)** | **4**            | Possible via advanced query (e.g. path trace). MeshCore learns optimal paths and stores them [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/7.2-routing-and-path-discovery), but it doesn’t broadcast full routing tables by default. Similar systems need explicit “traceroute” to reveal paths [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/neighbor-info/). Likely available to admins for diagnostics. |
| **PATH DISCOVERY**            | e.g. `trace_path` (CMD\_SEND\_TRACE\_PATH = 0x24) [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol)                                                                                                    | Over-air             | Any node; subject to rate limit (flood-based)                                                                                          | A path acknowledgment (PATH\_RETURN) with the hop sequence [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/7.2-routing-and-path-discovery)                         | NACK or no reply if target unreachable; ignored if overused                                                                                                                        | **Direct + Analog**     | **4**            | Supported via a dedicated mechanism. The first flood to a new node triggers a PATH\_RETURN in MeshCore [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/7.2-routing-and-path-discovery). Likely a “traceroute”-like command exists to actively request current path info. Useful for route debugging, but flood-based so probably limited in frequency.                                                                               |
| **CHANNELS (List/Sync)**      | `CMD_GET_CHANNEL` (0x1F) [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol)                                                                                                                             | Over-air, USB/BLE    | Auth = Admin or trusted peer (sensitive data)                                                                                          | Channel identifiers or metadata (e.g. names, modes; not raw keys) shared with requester                                                                                          | Error/denial if not authorized; private channels omitted                                                                                                                           | **Direct + Inference**  | **4**            | Likely supported in controlled scenarios. MeshCore’s protocol has commands to get/set channel info [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol), implying nodes can exchange channel configurations. However, since channels involve encryption keys, only highly trusted requests (paired companion apps or admin nodes) would be honored.                                                               |
| **METRICS / HEALTH**          | *“Get Stats” request (CMD\_GET\_STATS = 0x38)* [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol), [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference) | Over-air, USB/BLE    | None or guest (read-only allowed) [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference) | Status counters and health info (uptime, packet counts, etc.)                                                                                                                    | None (read-only); perhaps empty fields if no data                                                                                                                                  | **Direct (MeshCore)**   | **4**            | Supported for network monitoring. Repeaters can report stats (e.g. airtime usage, packets forwarded) to any logged-in user. The repeater even allows guest-level “Get Stats” requests [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference), indicating this is a safe, routine command.                                                                                                            |
| **LINK-QUALITY TEST**         | *(No single command; use `advert` or range-test module)*                                                                                                                                                                                   | Over-air             | Coordination between nodes; perhaps module-enabled                                                                                     | Periodic signal or test packets and measured RSSI/SNR results                                                                                                                    | Results may not return if test not synchronized; heavy use triggers rate limits                                                                                                    | **Analog (Meshtastic)** | **3**            | Possibly available via custom use. While MeshCore doesn’t have a built-in “LQT” CLI, one can send test packets (e.g. repeated adverts) to gauge link quality. Other mesh systems provide a range-test mode [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/range-test/). Likely achievable with add-on tools, but not a dedicated core command.                                                                              |
| **DEVICE STATUS**             | e.g. Battery/Storage (`CMD_GET_BATT_AND_STORAGE=0x14`) [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol)                                                                                               | USB/BLE (local)      | Auth = Admin; often serial-only for full detail                                                                                        | Battery level, memory or temp readout on console                                                                                                                                 | “Denied” if attempted OTA; no OTA implementation for some stats                                                                                                                    | **Direct (MeshCore)**   | **2**            | Unlikely to be exposed OTA. Hardware status is accessible via local interfaces (companion app queries battery [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol)), but not broadcast over mesh for security and low utility. Most networks keep such info local to prevent abuse.                                                                                                                               |

<small>**Legend:** *Transport* = how command is sent; *Serial only: Yes* means local console only. *Auth* = required permission level. Likelihood scores: **5 = Very likely**, **4 = Likely**, **3 = Possible**, **2 = Unlikely**, \*\*1 = Very unlikely.\*</small> [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)

## Evidence Pack

*   **MeshCore CLI Reference (Unofficial)** — *“`ver` – All – No – Print firmware version…  `advert` – All – No – Transmit a 400 ms flood advert…  `neighbors` – Repeater – No – Dump current neighbour table with RSSI & airtime stats.”*\
    *Why it matters:* This official command list (remote **Serial only: No** means allowed OTA) confirms that **version info**, manual **advertisement broadcasts**, and **neighbor table dumps** are available over-the-air on a repeater. These are straightforward, read-only commands, showing what repeaters will readily respond to. [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference), [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)
*   **Meshtastic User Discussion (Reddit)** — *“Double clicking the user button sends ad hoc pings which will get responses if nodes are in range.”*\
    *Why it matters:* Demonstrates the concept of a **mesh ping** in practice. In the Meshtastic open-source mesh, nodes can send a ping and receive responses from neighbors. MeshCore likely supports an analogous mechanism for connectivity checks, given its similar peer-to-peer design. [\[reddit.com\]](https://www.reddit.com/r/meshtastic/comments/1cjppl0/can_we_ping_the_mesh/)
*   **MeshCore Deepwiki – Routing** — *“**MeshCore Routing** – First Message: FLOOD to discover path; **PATH\_RETURN** packet teaches sender the route; Subsequent Messages: DIRECT via learned path… Only hops in path\[] forward.”*\
    *Why it matters:* Shows MeshCore’s built-in **path discovery** process. The presence of a `PATH_RETURN` response packet implies that a repeater will answer a path discovery request with the route information. This supports the idea that a **trace route command** (explicit or implicit) is honored by repeaters to facilitate direct routing. [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/7.2-routing-and-path-discovery)
*   **MeshCore Deepwiki – Command Protocol** — *“**Channel Management** – CMD\_GET\_CHANNEL 0x1F, CMD\_SET\_CHANNEL 0x20…”*\
    *Why it matters:* MeshCore’s command set includes explicit opcodes for **getting and setting channel info**. This indicates that a node (likely a companion app or admin) can request a repeater’s channel configuration. It’s evidence that **channel queries** are implemented, though presumably protected since channels carry network keys. [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol)
*   **MeshCore GitHub Wiki (Repeater CLI)** — *“(for repeaters, guest logins can send the ‘Get Stats’ request)”*\
    *Why it matters:* This note on the repeater’s guest password shows that even non-admin users can invoke a **Get Stats command** on a repeater. It directly confirms that MeshCore repeaters accept and respond to a **metrics/health query** (stats) over the air, treating it as a low-risk operation open to guests. [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference)
*   **Meshtastic Neighbor Info Doc** — *“Meshtastic does not keep track of the route a packet is taking… except when using Traceroute. Enabling this \[neighbor info] module… your node will periodically send out a packet with a list of its direct neighbors and the quality (SNR) of the link.”*\
    *Why it matters:* Emphasizes how **route details are normally restricted** in mesh networks. Instead, nodes share only neighbor lists and link quality periodically. MeshCore likely follows this principle: direct neighbor info is easy to get, but a full route requires a special trace. It highlights why **route table queries** might need a dedicated command or elevated rights. [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/neighbor-info/)
*   **Meshtastic Range Test (Docs)** — *“This module lets you test the communication range between two Meshtastic nodes… Sender: fixed node that sends sequential packets… Receiver: mobile node… Nodes are in range as long as the packets can be received.”*\
    *Why it matters:* Illustrates an example of a **link-quality testing procedure** in an open mesh system. MeshCore doesn’t list a specific “range test” CLI, but this Meshtastic feature suggests how users can manually measure link quality by exchanging test packets. It supports the inference that MeshCore repeaters could engage in similar testing (though via add-on tools or deliberate ping floods). [\[meshtastic.org\]](https://meshtastic.org/docs/configuration/module/range-test/)
*   **MeshCore CLI Reference (Unofficial)** — *“`erase` – All – Yes – Requires physical console (ignored remotely)… `log` – All – Yes – Stream log file to console. Requires physical console (ignored remotely).”*\
    *Why it matters:* Shows **privileged commands are not accepted OTA**. The repeater’s firmware specifically ignores certain commands (formatting storage, dumping logs) when they come from remote nodes. This underscores the security design: **destructive or highly sensitive operations are local-only**, and a repeater will refuse them if sent over the mesh. [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference), [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)

## Notes & Caveats

*   **Authentication & Roles:** MeshCore enforces role-based access for remote commands. Repeaters maintain an **Access Control List (ACL)** of trusted node public keys, with permission levels 0=Guest, 1=Read-only, 2=Read-write, 3=Admin. A node must log in (via a shared secret or password) to issue anything beyond public pings. **Read-only users (guests)** can run benign queries (e.g. get stats) while **Admin rights** are required for critical commands. Unauthorized or unknown senders are ignored by the repeater for protected commands. [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference)

*   **Serial-Only Restrictions:** Several maintenance commands are deliberately **disabled for OTA use**. For example, `erase` (formatting the file system) and full `log` retrieval are flagged as “Serial only” and **will be ignored if sent remotely**. This means a remote node cannot wipe a repeater or steal its entire log over the air – such actions require physical connection (USB/BLE) and likely the admin password. This design contains the impact of potentially dangerous commands to local sessions. [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference), [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)

*   **Rate Limiting & Flood Control:** MeshCore repeaters employ flood control settings to prevent abuse. For instance, configuration keys like `flood.max` limit how many times a message will be rebroadcast, and minimum intervals are enforced for adverts (e.g. at least 60 minutes for local adverts). Thus, commands that inherently use flooding (e.g. path discovery or network-wide pings) are subject to throttling. A repeater will silently drop or delay requests if they would violate these rate limits, ensuring network stability. Users should space out repeated pings or path traces to avoid triggering these limits. [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference)

*   **Transport Differences:** **Local console access (USB or BLE)** exposes more functionality than OTA. For example, battery level and storage info are automatically shown in companion apps (via `CMD_GET_BATT_AND_STORAGE` in the protocol), but there is no standalone CLI command to query battery over the mesh. Similarly, a privileged command like `reboot` *can* be invoked OTA (it’s not marked serial-only), but doing so will simply restart the repeater without confirmation – the remote requester just sees a timeout as the node goes offline. In practice, such commands are used sparingly and typically via direct management channels. [\[deepwiki.com\]](https://deepwiki.com/meshcore-dev/MeshCore/4.1.2-command-protocol) [\[wiki.meshcoreaus.org\]](https://wiki.meshcoreaus.org/books/doc-firmware/page/doc-cli-reference) [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference)

*   **Firmware Version Differences:** The core set of remote commands is consistent across MeshCore versions, but new firmware updates do introduce additional commands (often for local use). For example, support for `owner.info` and region management commands appeared around v1.12. These don’t affect the fundamental commands listed above, but they show the project’s trajectory: more admin utilities (regions, GPS control, etc.) are being added, usually with appropriate restrictions. Always consult the firmware’s documentation version that matches the repeater’s software to know which commands are available and how they’re secured. [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference), [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference)

## Safe Read-Only Test Plan (Optional)

To safely verify a MeshCore repeater’s responsive commands in the field, follow a cautious, **read-only probe sequence**:

1.  **Silent Ping:** Begin with a low-impact connectivity check. For example, send a **`ping`** or **`advert`** command to the repeater. This will either elicit a benign response (like the repeater’s ID in your neighbor list) or nothing at all, without changing any state. Wait a moment and observe if any acknowledgment (e.g. an advert packet or an LED blink on the device) is returned.

2.  **Basic Info Query:** If the repeater is reachable, request its **version info** (`ver`). This confirms two things: your ability to send a remote CLI command and the repeater’s firmware details. The response should be immediate – note the firmware version to ensure you use compatible commands thereafter. (If no response, the repeater may require authentication – at this point, do not proceed to more commands without proper access.)

3.  **Neighbor and Channel Check:** Next, retrieve the **neighbor list** (`neighbors`) to gauge network connectivity. This read-out will list which nodes the repeater hears, with signal metrics, and will not disturb any operation. You can also issue **channel queries** if you have admin rights and suspect a misconfiguration (e.g. `get channel` to see if it’s on the expected frequency/network). Space these commands out by at least a few seconds to respect the device’s processing and avoid back-to-back commands.

4.  **Path Discovery (if needed):** If you need to verify multi-hop routes through this repeater, perform a controlled **path discovery**. For example, send a message or a `trace_path` command to a known node beyond the repeater and monitor for a path return. Do this sparingly – ideally only once – as it triggers a network-wide flood. Ensure the network isn’t busy, and allow the repeater to settle for a minute after this operation.

5.  **Retrieve Stats:** Finally, use the **Get Stats** functionality to collect the repeater’s performance metrics. Run the stats query to see packet counters, uptime, or other health indicators. This is read-only and cheap to execute. It will confirm that the repeater is functioning normally from a network perspective (e.g., increasing message counts, etc.). If the repeater’s guest access is enabled, you can do this without an admin login. Otherwise, authenticate as an admin before retrieving stats. [\[github.com\]](https://github.com/meshcore-dev/MeshCore/wiki/Repeater-&-Room-Server-CLI-Reference)

**Best Practices:** Always wait for a response or a timeout for each step before moving on. If a command returns an error or no response, **do not keep retrying quickly** – pause and investigate whether authentication or syntax is an issue. Use exponential backoff for retries to avoid overwhelming the repeater. Log each command and response with timestamps. This log can be reviewed later or cross-checked with the repeater’s internal log (if accessible via serial) for any warning messages (e.g. “unauthorized command” notes). By sequentially progressing from harmless pings to more informative queries, you ensure the repeater is never put at risk and that you gather maximum information with minimal intrusion.
